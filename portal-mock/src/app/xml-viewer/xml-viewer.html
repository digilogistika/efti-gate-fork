<div class="space-y-3 text-gray-800 text-sm">
  @for (node of nodes; track $index) {
    <div>
      <div class="flex flex-col">
        <!-- Main Line: This is always visible -->
        <div
          class="flex items-start rounded-md"
          [class.cursor-pointer]="hasContentToExpand(node)"
          [class.hover:bg-indigo-50]="hasContentToExpand(node)"
          (click)="toggle(node)"
        >

          <!-- Expander Icon -->
          @if (hasContentToExpand(node)) {
            <div class="w-5 h-5 flex-shrink-0 flex items-center justify-center text-gray-500 pt-px">
              <svg class="w-3 h-3 transition-transform duration-200"
                   [class.rotate-90]="node.isExpanded" fill="none"
                   stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
              </svg>
            </div>
          }
          <!-- Key and Value -->
          <div class="flex space-x-2">
            <span class="font-medium text-gray-600">{{ formatKey(node.name) }}:</span>
            @if (node.value) {
              <span class="font-semibold text-indigo-800">{{ node.value }}</span>
            }
          </div>
        </div>

        <!-- Collapsible Content (Attributes and Children) -->
        @if (node.isExpanded && hasContentToExpand(node)) {
          <div class="mt-1 pl-5 border-l-2 border-indigo-100 space-y-2 py-2">
            <!-- Render attributes -->
            @for (attr of node.attributes; track attr.key) {
              <div class="flex space-x-2">
                <span class="text-gray-500 font-medium flex-shrink-0">{{ formatKey(attr.key) }}:</span>
                <span class="text-gray-800">{{ attr.value }}</span>
              </div>
            }

            <!-- Recursive call for children -->
            @if (node.children.length > 0) {
              <app-xml-viewer [nodes]="node.children" [level]="0"></app-xml-viewer>
            }
          </div>
        }
      </div>
    </div>
  }
</div>
