{
	"info": {
		"_postman_id": "9de929ba-c943-4d32-9764-ffa86fa8c44e",
		"name": "eFTI-DLK",
		"description": "eFTI gate request collection for different use cases",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "35147351"
	},
	"item": [
		{
			"name": "BO",
			"item": [
				{
					"name": "Gate",
					"item": [
						{
							"name": "GET Identifiers Control",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://localhost:8880/v1/identifiers/tybkuj?eftiGateIndicator=EE,BO",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8880",
									"path": [
										"v1",
										"identifiers",
										"tybkuj"
									],
									"query": [
										{
											"key": "eftiGateIndicator",
											"value": "BO",
											"disabled": true
										},
										{
											"key": "eftiGateIndicator",
											"value": "EE,BO"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Dataset Control",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let responseData = pm.response.json();",
											"pm.globals.set(\"requestId\", responseData.requestId);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://localhost:8880/v1/dataset/borduria/acme/5d5f8df4-e70c-4f8f-aa7e-6737d9ee9915?subsets=full",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8880",
									"path": [
										"v1",
										"dataset",
										"borduria",
										"acme",
										"5d5f8df4-e70c-4f8f-aa7e-6737d9ee9915"
									],
									"query": [
										{
											"key": "subsets",
											"value": "full"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "POST Follow Up For UIL",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"message\" : \"Hello ACME!\",\n    \"requestId\": \"{{requestId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://localhost:8880/v1/follow-up",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8880",
									"path": [
										"v1",
										"follow-up"
									]
								}
							},
							"response": []
						},
						{
							"name": "REGISTER platform",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"platformId\": \"test-plataaa\",\n    \"requestBaseUrl\": \"http://test-base-url.com/api/gate-api/v0/consignments/\",\n    \"headers\": [\n        {\n            \"key\": \"X-API-Key\",\n            \"value\": \"SuperSecretApiKey\"\n        }\n    ]\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://localhost:8880/api/admin/platform/register",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8880",
									"path": [
										"api",
										"admin",
										"platform",
										"register"
									]
								}
							},
							"response": []
						},
						{
							"name": "REGISTER authority",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"// Parse the JSON response body",
											"let response = pm.response.json();",
											"",
											"// Check if the apiKey exists in the response",
											"if (response.apiKey) {",
											"    // Set the environment variable",
											"    pm.globals.set(\"authority_user_api_key\", response.apiKey);",
											"    console.log(\"authority_user_api_key set to:\", response.apiKey);",
											"} else {",
											"    console.warn(\"apiKey not found in response.\");",
											"}",
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"authorityId\": \"testa-aaauthaaorityss\",\n    \"permissionLevel\": 0\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://localhost:8880/api/admin/authority/register",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8880",
									"path": [
										"api",
										"admin",
										"authority",
										"register"
									]
								}
							},
							"response": []
						},
						{
							"name": "REGISTER gate",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "POST",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"country\": \"EE\",\n    \"gateId\": \"estonia\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://localhost:8880/api/admin/gate/register",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8880",
									"path": [
										"api",
										"admin",
										"gate",
										"register"
									]
								}
							},
							"response": []
						},
						{
							"name": "DELETE gate",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "DELETE",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://localhost:8880/api/admin/gate/delete/estonia",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8880",
									"path": [
										"api",
										"admin",
										"gate",
										"delete",
										"estonia"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Platform",
					"item": [
						{
							"name": "Upload Identifiers [REST method]",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"// Access the form data in the request",
											"const formData = pm.request.body.formdata;",
											"",
											"const a = formData[0]",
											"formData.map(i => {",
											"    if (i.key === \"consignmentFile\") {",
											"        const fileName = i.src.split(\"/\").at(-1).split(\".\").at(0)",
											"        pm.environment.set(\"uploaded_dataset_it\", fileName);",
											"    }",
											"})"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "consignmentFile",
											"type": "file",
											"src": "/home/rasmus/proge/gates/efti-gate/testdata/5d5f8df4-e70c-4f8f-aa7e-6737d9ee9915.xml"
										}
									]
								},
								"url": {
									"raw": "http://localhost:8070/identifiers/upload/consignment/{{uploaded_dataset_it}}",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8070",
									"path": [
										"identifiers",
										"upload",
										"consignment",
										"{{uploaded_dataset_it}}"
									]
								}
							},
							"response": []
						}
					]
				}
			],
			"description": "Borduria local development requests"
		},
		{
			"name": "EE",
			"item": [
				{
					"name": "Gate",
					"item": [
						{
							"name": "GET Identifiers Control",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://localhost:8881/v1/identifiers/tybkuj?eftiGateIndicator=EE,BO",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8881",
									"path": [
										"v1",
										"identifiers",
										"tybkuj"
									],
									"query": [
										{
											"key": "eftiGateIndicator",
											"value": "BO",
											"disabled": true
										},
										{
											"key": "eftiGateIndicator",
											"value": "EE,BO"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Dataset Control",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"let responseData = pm.response.json();",
											"pm.globals.set(\"requestId\", responseData.requestId);"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "GET",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://localhost:8881/v1/dataset/borduria/acme/5d5f8df4-e70c-4f8f-aa7e-6737d9ee9915?subsets=full",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8881",
									"path": [
										"v1",
										"dataset",
										"borduria",
										"acme",
										"5d5f8df4-e70c-4f8f-aa7e-6737d9ee9915"
									],
									"query": [
										{
											"key": "subsets",
											"value": "full"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "POST Follow Up For UIL",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"message\" : \"LENS > PSG\",\n    \"requestId\": \"{{requestId}}\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://localhost:8881/v1/follow-up",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8881",
									"path": [
										"v1",
										"follow-up"
									]
								}
							},
							"response": []
						},
						{
							"name": "REGISTER platform",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"platformId\": \"test-plataa\",\n    \"requestBaseUrl\": \"http://test-base-url.com/api/gate-api/v0/consignments/\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://localhost:8881/api/admin/platform/register",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8881",
									"path": [
										"api",
										"admin",
										"platform",
										"register"
									]
								}
							},
							"response": []
						},
						{
							"name": "REGISTER authority",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"authorityId\": \"test-authority\",\n    \"permissionLevel\": 0\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://localhost:8881/api/admin/authority/register",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8881",
									"path": [
										"api",
										"admin",
										"authority",
										"register"
									]
								}
							},
							"response": []
						},
						{
							"name": "REGISTER gate",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "POST",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"country\": \"BO\",\n    \"gateId\": \"borduria\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "http://localhost:8881/api/admin/gate/register",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8881",
									"path": [
										"api",
										"admin",
										"gate",
										"register"
									]
								}
							},
							"response": []
						},
						{
							"name": "DELETE gate",
							"request": {
								"auth": {
									"type": "noauth"
								},
								"method": "DELETE",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"url": {
									"raw": "http://localhost:8881/api/admin/gate/delete/borduria",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8881",
									"path": [
										"api",
										"admin",
										"gate",
										"delete",
										"borduria"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Platform",
					"item": [
						{
							"name": "Upload Identifiers [REST method]",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"// Access the form data in the request",
											"const formData = pm.request.body.formdata;",
											"",
											"const a = formData[0]",
											"formData.map(i => {",
											"    if (i.key === \"consignmentFile\") {",
											"        const fileName = i.src.split(\"/\").at(-1).split(\".\").at(0)",
											"        pm.environment.set(\"uploaded_dataset_it\", fileName);",
											"    }",
											"})"
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "X-API-Key",
										"value": "SuperSecretSecret123",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "consignmentFile",
											"type": "file",
											"src": "/home/rig/Documents/Projects/DLK/efti-gate/testing/testdata/5d5f8df4-e70c-4f8f-aa7e-6737d9ee9915.xml"
										}
									]
								},
								"url": {
									"raw": "http://localhost:8072/identifiers/upload/consignment/{{uploaded_dataset_it}}",
									"protocol": "http",
									"host": [
										"localhost"
									],
									"port": "8072",
									"path": [
										"identifiers",
										"upload",
										"consignment",
										"{{uploaded_dataset_it}}"
									]
								}
							},
							"response": []
						}
					]
				}
			],
			"description": "Listenbourg local development requests"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	]
}